<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hello World</title>
    <link rel="stylesheet" href="css/app.css">
</head>
<body>
    
</body>
<script src="js/pixi.min.js"></script>
<script src="js/scaleToWindow.js"></script>
<script type="text/javascript">
	//PIXI init
    let type = "WebGL"
    if(!PIXI.utils.isWebGLSupported()){
        type = "canvas"
    }
    PIXI.utils.sayHello(type);

    //Aliases
    let Application = PIXI.Application,
    	loader = PIXI.loader,
    	resources = PIXI.loader.resources,
    	Sprite = PIXI.Sprite;
    	TextureCache = PIXI.utils.TextureCache;
    	Rectangle = PIXI.Rectangle;

    //Create a Pixi Application
    let app = new Application({
    	width: 256,         		// default: 800
	    height: 256,        		// default: 600
	    antialias: true,    		// default: false
	    transparent: false, 		// default: false
	    resolution: 1,      		// default: 1
	    // backgroundColor: 0x000000,	// default: 0x000000
    });

    //Adjusting a Pixi Application settings using renderer object
    app.renderer.backgroundColor = 0x061639;
    // app.renderer.autoResize = true;
    // app.renderer.resize(512, 512);

    //Make the canvas fill the entire window
    app.renderer.view.style.position = 'absolute';
    app.renderer.view.style.display = 'block';
    app.renderer.autoResize = true;
    app.renderer.resize(window.innerWidth, window.innerHeight);

    //Add the canvas that Pixi automatically created for you to the HTML document
    document.body.appendChild(app.view);

    //Auto resize the canvas every time the size of the browser window is changed
    window.addEventListener('resize', function(event){
    	scaleToWindow(app.view);
    });

    //Load an image and run the `setup` function when it's done
    loader
    	.add([
    		// 'img/robot.png',
    		// 'img/robot-jump.png',
    		// 'img/robot-jump-melee.png',
    		'img/treasureHunter.json'
    	])
    	.on('progress', loadProgressHandler)
    	.load(setup);

    function loadProgressHandler(loader, resources) {
    	//Display the file 'url' currently being loaded
    	console.log('loading: ' + resources.url);

    	//Display the percentage of files currently being loaded
    	console.log('progress: ' + loader.progress + '%');

    	//If you gave your files names as the first argument of the 'add' method, you can access them like this
    	// console.log('loading: ' + resources.name);
    }

    //Define variables that might be used in more than one function
    let map, explorer, enemy, door, treasure, id;

    //This `setup` function will run when the image has loaded
    function setup() {
    	console.log('All files loaded!');

    	//Create the sprite
    	// let robot = new Sprite(resources['img/robot-idle.png', 'img/robot-jump.png', 'img/robot-jump-melee.png'].texture);

    	//Change the sprite's position
    	// robot.position.set(100, 100);

    	//Change the sprite's size
    	// robot.scale.set(1, 1);

    	//Change the sprite's anchor point
    	// robot.anchor.set(0.5, 0.5);

    	//Rotate the sprites
    	// robot.rotation = 0.5;

    	//Add the sprite to the stage
    	// app.stage.addChild(robot);


    	//////////////////////////////////////////////////////////////////////

    	//Create the `tileset` sprite from the texture
    	// let robotTexture = TextureCache['img/robotSprites.png'];

    	//Create a rectangle object that defines the position and
		//size of the sub-image you want to extract from the texture
		//(`Rectangle` is an alias for `PIXI.Rectangle`)
		//PIXI.Rectangle(x, y, width, height);
		// let rectangle = new Rectangle(0, 0, 64, 64);

		//Tell the texture to use that rectangular section
		// robotTexture.frame = rectangle;

		//Create the sprite from the texture
		// let robotIdle = new Sprite(robotTexture);

		//Position the robot sprite on the canvas
		// robotIdle.position.set(50, 50);

		//Add the robot to the stage
		// app.stage.addChild(robotIdle);

		//Render the stage
		// app.renderer.render(app.stage);

		//////////////////////////////////////////////////////////////////////

		//There are 3 ways to make sprites from textures atlas frames

		//1. Access the `TextureCache` directly
		let mapTexture = TextureCache['map.png'];
		map = new Sprite(mapTexture);
		app.stage.addChild(map);

		//2. Access the texture using through the loader's `resources`:
		explorer = new Sprite(
			resources['img/treasureHunter.json'].textures['explorer.png']
		);
		explorer.x = 68;

		//Center the explorer vertically
		explorer.y = app.stage.height / 2 - explorer.height / 2;
		app.stage.addChild(explorer);

		//3. Create an optional alias called `id` for all the texture atlas frame id textures
		id = resources["img/treasureHunter.json"].textures;

		//Make the treasure box using the alias
		treasure = new Sprite(id['treasure.png']);
		app.stage.addChild(treasure);

		//Position the treasure next to the right edge of the canvas
		treasure.x = app.stage.width - treasure.width - 48;
		treasure.y = app.stage.height / 2 - treasure.height / 2;
		app.stage.addChild(treasure);
    }
</script>
</html>